(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1038:function(e,t,i){"use strict";t.__esModule=!0,t.default=t.PREVIEW_VALUE=void 0;var r=i(22);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t.PREVIEW_VALUE=12345.432;class o extends r.ExtensibleFunction{constructor(e){super(e=>this.format(e)),n(this,"id",void 0),n(this,"label",void 0),n(this,"description",void 0),n(this,"formatFunc",void 0),n(this,"isInvalid",void 0);const{id:t=(0,r.isRequired)("config.id"),label:i,description:o="",formatFunc:a=(0,r.isRequired)("config.formatFunc"),isInvalid:s=!1}=e;this.id=t,this.label=null!=i?i:t,this.description=o,this.formatFunc=a,this.isInvalid=s}format(e){return null==e||Number.isNaN(e)?""+e:e===Number.POSITIVE_INFINITY?"∞":e===Number.NEGATIVE_INFINITY?"-∞":this.formatFunc(e)}preview(e=12345.432){return e+" => "+this.format(e)}}var a=o;t.default=a},1045:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r={DOLLAR:"$,.2f",DOLLAR_ROUND:"$,d",DOLLAR_ROUND_SIGNED:"+$,d",DOLLAR_SIGNED:"+$,.2f",FLOAT:",.2f",FLOAT_1_POINT:",.1f",FLOAT_2_POINT:",.2f",FLOAT_3_POINT:",.3f",FLOAT_SIGNED:"+,.2f",FLOAT_SIGNED_1_POINT:"+,.1f",FLOAT_SIGNED_2_POINT:"+,.2f",FLOAT_SIGNED_3_POINT:"+,.3f",INTEGER:",d",INTEGER_SIGNED:"+,d",PERCENT:",.2%",PERCENT_1_POINT:",.1%",PERCENT_2_POINT:",.2%",PERCENT_3_POINT:",.3%",PERCENT_SIGNED:"+,.2%",PERCENT_SIGNED_1_POINT:"+,.1%",PERCENT_SIGNED_2_POINT:"+,.2%",PERCENT_SIGNED_3_POINT:"+,.3%",SI:".3s",SI_1_DIGIT:".1s",SI_2_DIGIT:".2s",SI_3_DIGIT:".3s",SMART_NUMBER:"SMART_NUMBER",SMART_NUMBER_SIGNED:"SMART_NUMBER_SIGNED"};t.default=r},1056:function(e,t,i){"use strict";t.__esModule=!0,t.default=function(e){const{description:t,formatString:i=(0,o.isRequired)("config.formatString"),label:r,locale:s}=e;let l,c=!1;try{l=void 0===s?(0,n.format)(i):(0,n.formatLocale)(s).format(i)}catch(e){l=e=>e+" (Invalid format: "+i+")",c=!0}return new a.default({description:t,formatFunc:l,id:i,isInvalid:c,label:r})};var r,n=i(500),o=i(22),a=(r=i(1038))&&r.__esModule?r:{default:r}},1058:function(e,t,i){"use strict";var r=i(1),n=i.n(r),o=i(0),a=i.n(o),s=i(321),l=i(1057),c=i(157),u=i(1063),d=i(1059),f=i(1051),p=i(1062),h=i(1041),m=i(1054);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const{getScale:_}=c.CategoricalColorNamespace;const v={formData:a.a.object.isRequired,mapboxApiKey:a.a.string.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,getLayer:a.a.func.isRequired,getPoints:a.a.func.isRequired,payload:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired};class y extends n.a.PureComponent{constructor(e){super(e),b(this,"containerRef",n.a.createRef()),b(this,"setTooltip",e=>{const{current:t}=this.containerRef;t&&t.setTooltip(e)}),this.state=this.getStateFromProps(e),this.getLayers=this.getLayers.bind(this),this.onValuesChange=this.onValuesChange.bind(this),this.toggleCategory=this.toggleCategory.bind(this),this.showSingleCategory=this.showSingleCategory.bind(this)}UNSAFE_componentWillReceiveProps(e){e.payload.form_data!==this.state.formData&&this.setState(g({},this.getStateFromProps(e)))}onValuesChange(e){this.setState({values:Array.isArray(e)?e:[e,e+this.state.getStep(e)]})}getStateFromProps(e,t){const i=e.payload.data.features||[],r=i.map(e=>e.__timestamp),n=function(e,t){const i=e.color_picker||{r:0,g:0,b:0,a:1},r=[i.r,i.g,i.b,255*i.a],n=_(e.color_scheme),o={};return t.forEach(t=>{if(null!=t.cat_color&&!o.hasOwnProperty(t.cat_color)){let a;a=e.dimension?Object(f.hexToRGB)(n(t.cat_color),255*i.a):r,o[t.cat_color]={color:a,enabled:!0}}}),o}(e.formData,i);if(t&&e.payload.form_data===t.formData)return g({},t,{categories:n});const o=e.payload.form_data.time_grain_sqla||e.payload.form_data.granularity||"P1D",{start:a,end:s,getStep:l,values:c,disabled:u}=Object(p.a)(r,o),{width:d,height:h,formData:b}=e;let{viewport:v}=e;return b.autozoom&&(v=Object(m.a)(v,{width:d,height:h,points:e.getPoints(i)})),{start:a,end:s,getStep:l,values:c,disabled:u,viewport:v,selected:[],lastClick:0,formData:e.payload.form_data,categories:n}}getLayers(e){const{getLayer:t,payload:i,formData:r,onAddFilter:n}=this.props;let o=i.data.features?[...i.data.features]:[];if(o=this.addColor(o,r),r.js_data_mutator){o=Object(h.a)(r.js_data_mutator)(o)}o=e[0]===e[1]||e[1]===this.end?o.filter(t=>t.__timestamp>=e[0]&&t.__timestamp<=e[1]):o.filter(t=>t.__timestamp>=e[0]&&t.__timestamp<e[1]);const a=this.state.categories;return r.dimension&&(o=o.filter(e=>a[e.cat_color]&&a[e.cat_color].enabled)),[t(r,g({},i,{data:g({},i.data,{features:o})}),n,this.setTooltip)]}addColor(e,t){const i=t.color_picker||{r:0,g:0,b:0,a:1},r=_(t.color_scheme);return e.map(e=>{let n;return t.dimension?(n=Object(f.hexToRGB)(r(e.cat_color),255*i.a),g({},e,{color:n})):e})}toggleCategory(e){const t=this.state.categories[e],i=g({},this.state.categories,{[e]:g({},t,{enabled:!t.enabled})});Object.values(i).every(e=>!e.enabled)&&Object.values(i).forEach(e=>{e.enabled=!0}),this.setState({categories:i})}showSingleCategory(e){const t=g({},this.state.categories);Object.values(t).forEach(e=>{e.enabled=!1}),t[e].enabled=!0,this.setState({categories:t})}render(){return n.a.createElement("div",{style:{position:"relative"}},n.a.createElement(u.a,{ref:this.containerRef,getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,disabled:this.state.disabled,viewport:this.state.viewport,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue,width:this.props.width,height:this.props.height},n.a.createElement(d.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position,format:this.props.formData.legend_format})))}}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function N(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}y.propTypes=v,i.d(t,"b",(function(){return E})),i.d(t,"a",(function(){return w}));const S={formData:a.a.object.isRequired,payload:a.a.object.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired},x={onAddFilter(){}};function E(e,t){class i extends n.a.PureComponent{constructor(e){super(e),N(this,"containerRef",n.a.createRef()),N(this,"setTooltip",e=>{const{current:t}=this.containerRef;t&&t.setTooltip(e)});const{width:i,height:r,formData:o}=e;let{viewport:a}=e;o.autozoom&&(a=Object(m.a)(a,{width:i,height:r,points:t(e.payload.data.features)})),this.state={viewport:a,layer:this.computeLayer(e)},this.onViewportChange=this.onViewportChange.bind(this)}UNSAFE_componentWillReceiveProps(e){const t=P({},e.formData,{viewport:null}),i=P({},this.props.formData,{viewport:null});Object(s.isEqual)(t,i)&&e.payload===this.props.payload||this.setState({layer:this.computeLayer(e)})}onViewportChange(e){this.setState({viewport:e})}computeLayer(t){const{formData:i,payload:r,onAddFilter:n}=t;return e(i,r,n,this.setTooltip)}render(){const{formData:e,payload:t,setControlValue:i,height:r,width:o}=this.props,{layer:a,viewport:s}=this.state;return n.a.createElement(l.a,{ref:this.containerRef,mapboxApiAccessToken:t.data.mapboxApiKey,viewport:s,layers:[a],mapStyle:e.mapbox_style,setControlValue:i,width:o,height:r,onViewportChange:this.onViewportChange})}}return i.propTypes=S,i.defaultProps=x,i}function w(e,t){function i(i){const{formData:r,payload:o,setControlValue:a,viewport:s,width:l,height:c}=i;return n.a.createElement(y,{formData:r,mapboxApiKey:o.data.mapboxApiKey,setControlValue:a,viewport:s,getLayer:e,payload:o,getPoints:t,width:l,height:c})}return i.propTypes=S,i.defaultProps=x,i}},1059:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(1),n=i.n(r),o=i(0),a=i.n(o),s=i(1065);i(1060);const l={categories:a.a.object,toggleCategory:a.a.func,showSingleCategory:a.a.func,format:a.a.string,position:a.a.oneOf([null,"tl","tr","bl","br"])};class c extends n.a.PureComponent{format(e){if(!this.props.format)return e;const t=parseFloat(e);return Object(s.formatNumber)(this.props.format,t)}formatCategoryLabel(e){if(!this.props.format)return e;if(e.includes(" - ")){const t=e.split(" - ");return this.format(t[0])+" - "+this.format(t[1])}return this.format(e)}render(){if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;const e=Object.entries(this.props.categories).map(e=>{let[t,i]=e;const r={color:"rgba("+i.color.join(", ")+")"},o=i.enabled?"◼":"◻";return n.a.createElement("li",{key:t},n.a.createElement("a",{href:"#",onClick:()=>this.props.toggleCategory(t),onDoubleClick:()=>this.props.showSingleCategory(t)},n.a.createElement("span",{style:r},o)," ",this.formatCategoryLabel(t)))}),t={position:"absolute",["t"===this.props.position.charAt(0)?"top":"bottom"]:"0px",["r"===this.props.position.charAt(1)?"right":"left"]:"10px"};return n.a.createElement("div",{className:"legend",style:t},n.a.createElement("ul",{className:"categories"},e))}}c.propTypes=l,c.defaultProps={categories:{},toggleCategory:()=>{},showSingleCategory:()=>{},format:null,position:"tr"}},1060:function(e,t,i){var r=i(501),n=i(1061);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1},a=(r(n,o),n.locals?n.locals:{});e.exports=a},1061:function(e,t,i){(t=i(502)(!1)).push([e.i,'/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * "License"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\ndiv.legend {\n  font-size: 90%;\n  position: absolute;\n  background: #fff;\n  box-shadow: 0 0 4px rgba(0, 0, 0, 0.15);\n  margin: 24px;\n  padding: 12px 20px;\n  outline: none;\n  overflow-y: scroll;\n  max-height: 200px;\n}\n\nul.categories {\n  list-style: none;\n  padding-left: 0;\n  margin: 0;\n}\n\nul.categories li a {\n  color: rgb(51, 51, 51);\n  text-decoration: none;\n}\n\nul.categories li a span {\n  margin-right: 10px;\n}\n',""]),e.exports=t},1065:function(e,t,i){"use strict";t.__esModule=!0,t.getNumberFormatter=t.formatNumber=t.PREVIEW_VALUE=t.createSiAtMostNDigitFormatter=t.createDurationFormatter=t.createD3NumberFormatter=t.getNumberFormatterRegistry=t.NumberFormatter=t.NumberFormats=void 0;var r=d(i(1045));t.NumberFormats=r.default;var n=u(i(1038));t.NumberFormatter=n.default,t.PREVIEW_VALUE=n.PREVIEW_VALUE;var o=u(i(1067));t.getNumberFormatterRegistry=o.default,t.formatNumber=o.formatNumber,t.getNumberFormatter=o.getNumberFormatter;var a=d(i(1056));t.createD3NumberFormatter=a.default;var s=d(i(1070));t.createDurationFormatter=s.default;var l=d(i(1073));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=r?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(i,n,o):i[n]=e[n]}return i.default=e,t&&t.set(e,i),i}function d(e){return e&&e.__esModule?e:{default:e}}t.createSiAtMostNDigitFormatter=l.default},1067:function(e,t,i){"use strict";t.__esModule=!0,t.getNumberFormatter=function(e){return a().get(e)},t.formatNumber=function(e,t){return a().format(e,t)},t.default=void 0;var r,n=i(22),o=(r=i(1068))&&r.__esModule?r:{default:r};const a=(0,n.makeSingleton)(o.default);var s=a;t.default=s},1068:function(e,t,i){"use strict";t.__esModule=!0,t.default=void 0;var r=i(22),n=s(i(1056)),o=s(i(1069)),a=s(i(1045));function s(e){return e&&e.__esModule?e:{default:e}}class l extends r.RegistryWithDefaultKey{constructor(){super({name:"NumberFormatter",overwritePolicy:r.OverwritePolicy.WARN}),this.registerValue(a.default.SMART_NUMBER,(0,o.default)()),this.registerValue(a.default.SMART_NUMBER_SIGNED,(0,o.default)({signed:!0})),this.setDefaultKey(a.default.SMART_NUMBER)}get(e){const t=(""+(null==e||""===e?this.defaultKey:e)).trim();if(this.has(t))return super.get(t);const i=(0,n.default)({formatString:t});return this.registerValue(t,i),i}format(e,t){return this.get(e)(t)}}t.default=l},1069:function(e,t,i){"use strict";t.__esModule=!0,t.default=function(e={}){const{description:t,signed:i=!1,id:r,label:a}=e,u=i?e=>e>0?"+":"":()=>"";return new n.default({description:t,formatFunc:e=>""+u(e)+function(e){if(0===e)return"0";const t=Math.abs(e);if(t>=1e3)return s(e).replace("G","B");if(t>=1)return l(e);if(t>=.001)return c(e);if(t>1e-6)return s(1e6*e)+"µ";return s(e)}(e),id:r||i?o.default.SMART_NUMBER_SIGNED:o.default.SMART_NUMBER,label:null!=a?a:"Adaptive formatter"})};var r=i(500),n=a(i(1038)),o=a(i(1045));function a(e){return e&&e.__esModule?e:{default:e}}const s=(0,r.format)(".3~s"),l=(0,r.format)(".2~f"),c=(0,r.format)(".4~f")},1070:function(e,t,i){"use strict";t.__esModule=!0,t.default=function(e={}){const{description:t,id:i,label:o,multiplier:a=1}=e,s=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,["description","id","label","multiplier"]);return new n.default({description:t,formatFunc:e=>(0,r.default)(e*a,s),id:null!=i?i:"duration_format",label:null!=o?o:"Duration formatter"})};var r=o(i(1071)),n=o(i(1038));function o(e){return e&&e.__esModule?e:{default:e}}},1071:function(e,t,i){"use strict";const r=i(1072);e.exports=(e,t={})=>{if(!Number.isFinite(e))throw new TypeError("Expected a finite number");t.colonNotation&&(t.compact=!1,t.formatSubMilliseconds=!1,t.separateMilliseconds=!1,t.verbose=!1),t.compact&&(t.secondsDecimalDigits=0,t.millisecondsDecimalDigits=0);const i=[],n=(e,r,n,o)=>{if(!(0!==i.length&&t.colonNotation||0!==e||t.colonNotation&&"m"===n))return;let a,s;if(o=(o||e||"0").toString(),t.colonNotation){a=i.length>0?":":"",s="";const e=o.includes(".")?o.split(".")[0].length:o.length,t=i.length>0?2:1;o="0".repeat(Math.max(0,t-e))+o}else a="",s=t.verbose?" "+(l=r,1===e?l:`${l}s`):n;var l;i.push(a+o+s)},o=r(e);if(n(Math.trunc(o.days/365),"year","y"),n(o.days%365,"day","d"),n(o.hours,"hour","h"),n(o.minutes,"minute","m"),t.separateMilliseconds||t.formatSubMilliseconds||e<1e3)if(n(o.seconds,"second","s"),t.formatSubMilliseconds)n(o.milliseconds,"millisecond","ms"),n(o.microseconds,"microsecond","µs"),n(o.nanoseconds,"nanosecond","ns");else{const e=o.milliseconds+o.microseconds/1e3+o.nanoseconds/1e6,i="number"==typeof t.millisecondsDecimalDigits?t.millisecondsDecimalDigits:0,r=e>=1?Math.round(e):Math.ceil(e),a=i?e.toFixed(i):r;n(Number.parseFloat(a,10),"millisecond","ms",a)}else{const i=((e,t)=>{const i=Math.floor(e*10**t+1e-7);return(Math.round(i)/10**t).toFixed(t)})(e/1e3%60,"number"==typeof t.secondsDecimalDigits?t.secondsDecimalDigits:1),r=t.keepDecimalsOnWholeSeconds?i:i.replace(/\.0+$/,"");n(Number.parseFloat(r,10),"second","s",r)}if(0===i.length)return"0"+(t.verbose?" milliseconds":"ms");if(t.compact)return i[0];if("number"==typeof t.unitCount){const e=t.colonNotation?"":" ";return i.slice(0,Math.max(t.unitCount,1)).join(e)}return t.colonNotation?i.join(""):i.join(" ")}},1072:function(e,t,i){"use strict";e.exports=e=>{if("number"!=typeof e)throw new TypeError("Expected a number");const t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60,milliseconds:t(e)%1e3,microseconds:t(1e3*e)%1e3,nanoseconds:t(1e6*e)%1e3}}},1073:function(e,t,i){"use strict";t.__esModule=!0,t.default=function(e={}){const{description:t,n:i=3,id:r,label:a}=e,s=(0,n.format)("."+i+"s");return new o.default({description:t,formatFunc:e=>{const t=s(e);return t.slice(-1)<"A"?parseFloat(t).toString():t},id:null!=r?r:"si_at_most_"+i+"_digit",label:null!=a?a:"SI with at most "+i+" significant digits"})};var r,n=i(500),o=(r=i(1038))&&r.__esModule?r:{default:r}},1137:function(e,t,i){"use strict";var r=i(1029),n=i(1030),o=i(1032),a=i(1031),s=i(1043),l=i(1033),c=i(1122),u=i(1099),d=i(1358),f=i(1216),p=i(1162);i.d(t,"a",(function(){return b}));var h=d.a.fp64LowPart,m=[0,0,0,255],g={radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,fp64:!1,filled:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:m},getLineColor:{type:"accessor",value:m},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},b=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(n.a)(t,[{key:"getShaders",value:function(e){return{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n  float outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, offset);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity) / 255.;\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity) / 255.;\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  } \n  if (distToCenter > innerUnitRadius) {\n    gl_FragColor = vLineColor;\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:4,transition:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(e){var i=e.props,r=e.oldProps,n=e.changeFlags;if(Object(s.a)(Object(a.a)(t.prototype),"updateState",this).call(this,{props:i,oldProps:r,changeFlags:n}),i.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(e){var t=e.uniforms,i=this.context.viewport,r=this.props,n=r.radiusScale,o=r.radiusMinPixels,a=r.radiusMaxPixels,s=r.stroked,l=r.filled,c=r.lineWidthUnits,u=r.lineWidthScale,d=r.lineWidthMinPixels,f=r.lineWidthMaxPixels,p="pixels"===c?i.distanceScales.metersPerPixel[2]:1;this.state.model.setUniforms(Object.assign({},t,{stroked:s?1:0,filled:l,radiusScale:n,radiusMinPixels:o,radiusMaxPixels:a,lineWidthScale:u*p,lineWidthMinPixels:d,lineWidthMaxPixels:f})).draw()}},{key:"_getModel",value:function(e){return new f.a(e,Object.assign(this.getShaders(),{id:this.props.id,geometry:new p.a({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0])}}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(e,t){var i=t.startRow,r=t.endRow,n=this.use64bitPositions();if(e.constant=!n,n){var o=this.props,a=o.data,s=o.getPosition,l=e.value,u=i*e.size,d=Object(c.a)(a,i,r),f=d.iterable,p=d.objectInfo,m=!0,g=!1,b=void 0;try{for(var _,v=f[Symbol.iterator]();!(m=(_=v.next()).done);m=!0){var y=_.value;p.index++;var P=s(y,p);l[u++]=h(P[0]),l[u++]=h(P[1])}}catch(e){g=!0,b=e}finally{try{m||null==v.return||v.return()}finally{if(g)throw b}}}else e.value=new Float32Array(2)}}]),t}(u.a);b.layerName="ScatterplotLayer",b.defaultProps=g},1223:function(e,t,i){"use strict";i.r(t);var r=i(1137),n=i(1),o=i.n(n),a=i(3),s=i(1048),l=i(1058),c=i(1050);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function d(e,t,i,n){const l=e,d=t.data.features.map(e=>{let t=(i=l.point_unit,r=e.radius,("square_m"===i?Math.sqrt(r/Math.PI):"radius_m"===i?r:"radius_km"===i?1e3*r:"radius_miles"===i?1609.34*r:"square_km"===i?1e3*Math.sqrt(r/Math.PI):"square_miles"===i?1609.34*Math.sqrt(r/Math.PI):null)||10);var i,r;if(l.multiplier&&(t*=l.multiplier),e.color)return u({},e,{radius:t});const n=l.color_picker||{r:0,g:0,b:0,a:1};return u({},e,{radius:t,color:[n.r,n.g,n.b,255*n.a]})});return new r.a(u({id:"scatter-layer-"+l.slice_id,data:d,fp64:!0,getFillColor:e=>e.color,getRadius:e=>e.radius,radiusMinPixels:l.min_radius||null,radiusMaxPixels:l.max_radius||null,stroked:!1},Object(s.a)(l,n,function(e){return t=>o.a.createElement("div",{className:"deckgl-tooltip"},o.a.createElement(c.a,{label:Object(a.t)("Longitude and Latitude")+": ",value:t.object.position[0]+", "+t.object.position[1]}),t.object.cat_color&&o.a.createElement(c.a,{label:Object(a.t)("Category")+": ",value:""+t.object.cat_color}),t.object.metric&&o.a.createElement(c.a,{label:e.point_radius_fixed.value.label+": ",value:""+t.object.metric}))}(l))))}i.d(t,"getLayer",(function(){return d}));t.default=Object(l.a)(d,(function(e){return e.map(e=>e.position)}))},500:function(e,t,i){"use strict";i.r(t);var r=i(1025);i.d(t,"formatDefaultLocale",(function(){return r.a})),i.d(t,"format",(function(){return r.b})),i.d(t,"formatPrefix",(function(){return r.c}));var n=i(320);i.d(t,"formatLocale",(function(){return n.a}));var o=i(217);i.d(t,"formatSpecifier",(function(){return o.b})),i.d(t,"FormatSpecifier",(function(){return o.a}));var a=i(1028);i.d(t,"precisionFixed",(function(){return a.a}));var s=i(1026);i.d(t,"precisionPrefix",(function(){return s.a}));var l=i(1027);i.d(t,"precisionRound",(function(){return l.a}))}}]);