(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{842:function(t,e,a){"use strict";a.r(e),a.d(e,"getLayer",(function(){return b}));var r=a(0),o=a.n(r),n=a(2),i=a.n(n),s=a(699),p=a(679),u=a(712),l=a(711),c=a(693),d=a(688),f=a(700);function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(){return(g=Object.assign||function(t){for(var e,a=1;a<arguments.length;a++)for(var r in e=arguments[a])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)}function m(t){return o.a.createElement("div",{className:"deckgl-tooltip"},o.a.createElement(f.a,{label:Object(p.b)("Longitude and Latitude")+": ",value:t.object.position[0]+", "+t.object.position[1]}),o.a.createElement(f.a,{label:Object(p.b)("Weight")+": ",value:""+t.object.weight}))}function b(t,e,a,r,o,n,i){var p=t,u=p.color_picker,l=e.data.features.map((function(t){return g({},t,{color:[u.r,u.g,u.b,255*u.a]})}));if(p.js_data_mutator){var f=Object(c.a)(p.js_data_mutator);l=f(l)}return null!=i&&i.forEach((function(t){l=l.filter(t)})),new s.h(g({id:"screengrid-layer-"+p.slice_id,data:l,pickable:!0,cellSizePixels:p.grid_size,minColor:[u.r,u.g,u.b,0],maxColor:[u.r,u.g,u.b,255*u.a],outline:!1,getWeight:function(t){return t.weight||0}},Object(d.a)(p,r,m)))}var v={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},y=function(t){function e(a){var r;return(r=t.call(this,a)||this).state=e.getDerivedStateFromProps(a),r.getLayers=r.getLayers.bind(h(r)),r.onValuesChange=r.onValuesChange.bind(h(r)),r.onViewportChange=r.onViewportChange.bind(h(r)),r}(function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e})(e,t),e.getDerivedStateFromProps=function(t,e){if(e&&t.payload.form_data===e.formData)return null;var a=t.payload.data.features||[],r=a.map((function(t){return t.__timestamp})),o=t.payload.form_data.time_grain_sqla||t.payload.form_data.granularity||"P1D",n=Object(l.a)(r,o);return{start:n.start,end:n.end,getStep:n.getStep,values:n.values,disabled:n.disabled,viewport:t.formData.autozoom?Object(d.b)(t.viewport,function(t){return t.map((function(t){return t.position}))}(a)):t.viewport,selected:[],lastClick:0,formData:t.payload.form_data}};var a=e.prototype;return a.onValuesChange=function(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})},a.onViewportChange=function(t){this.setState({viewport:t})},a.getLayers=function(t){var e=[];return t[0]===t[1]||t[1]===this.end?e.push((function(e){return e.__timestamp>=t[0]&&e.__timestamp<=t[1]})):e.push((function(e){return e.__timestamp>=t[0]&&e.__timestamp<t[1]})),[b(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip)]},a.render=function(){var t=this.props,e=t.formData,a=t.payload,r=t.setControlValue;return o.a.createElement("div",null,o.a.createElement(u.a,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,onValuesChange:this.onValuesChange,disabled:this.state.disabled,viewport:this.state.viewport,onViewportChange:this.onViewportChange,mapboxApiAccessToken:a.data.mapboxApiKey,mapStyle:e.mapbox_style,setControlValue:r,aggregation:!0}))},e}(o.a.PureComponent);y.propTypes=v,y.defaultProps={onAddFilter:function(){},setTooltip:function(){}},e.default=y}}]);